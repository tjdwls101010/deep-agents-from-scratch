# 🧱 처음부터 시작하는 딥 에이전트

<img width="720" height="289" alt="Screenshot 2025-08-12 at 2 13 54 PM" src="https://github.com/user-attachments/assets/90e5a7a3-7e88-4cbe-98f6-5b2581c94036" />

## 🤔 딥 에이전트란 무엇인가요?

단순히 LLM이 도구를 반복적으로 호출하는 것은 가장 기본적인 형태의 에이전트입니다. 하지만 이러한 구조는 복잡하고 긴 작업을 계획하고 수행하는 데 실패하는 "얕은(shallow)" 에이전트를 만들 수 있습니다.

"딥 리서치", "Manus", "Claude Code"와 같은 애플리케이션들은 다음과 같은 핵심 요소들을 결합하여 이러한 한계를 극복하고, 더 깊이 있는 추론과 계획을 수행하는 **"딥 에이전트"** 아키텍처를 구현했습니다.

### ⚙️ 어떻게 작동하나요?

딥 에이전트는 여러 컴포넌트가 유기적으로 상호작용하며 복잡한 문제를 해결합니다. 각 컴포넌트의 구체적인 작동 방식은 다음과 같습니다.

#### **📝 계획 (Planning as Recitation)**

- **작동 방식:** 에이전트는 작업을 시작하기 전에 `write_todos`와 같은 도구를 사용하여 전체 작업 계획을 명시적으로 작성합니다. 이 계획은 단순한 단계 목록이 아니라, 에이전트가 앞으로 수행할 작업에 대한 "암송(recitation)"입니다.
- **예시:** "최신 AI 기술 동향 보고서 작성"이라는 목표를 받으면, 에이전트는 다음과 같은 TODO 리스트를 생성합니다:
	1. [ ] 관련 키워드로 웹 검색 수행 (`search_web`)
	2. [ ] 검색 결과를 요약하여 `summary.txt` 파일에 저장 (`write_file`)
	3. [ ] 요약 내용을 바탕으로 보고서 초안 작성 (`write_file`)
	4. [ ] 초안 검토 및 수정 (`edit_file`)
- **장점:** 이 과정을 통해 에이전트는 스스로의 생각을 구조화하고, 목표에서 벗어나는 것을 방지하며, 사용자는 에이전트의 작업 흐름을 명확하게 파악할 수 있습니다.

#### **🗂️ 파일 시스템 (Context Offloading)**

- **작동 방식:** 에이전트는 제한된 컨텍스트 창(메모리)에 모든 정보를 담아두는 대신, `write_file`, `read_file`, `ls`와 같은 도구를 사용하여 가상의 파일 시스템에 중간 결과물이나 중요한 정보를 저장하고 검색합니다.
- **예시:** 웹 검색 후 찾은 수십 개의 아티클 내용을 전부 컨텍스트에 넣는 대신, 핵심 내용만 요약하여 `research_notes.txt` 파일로 저장합니다. 나중에 보고서를 작성할 때, 에이전트는 이 파일만 읽어 필요한 정보를 다시 불러올 수 있습니다.
- **장점:** 토큰 사용량을 획기적으로 줄여 비용을 절감하고, 훨씬 더 길고 복잡한 작업을 수행할 수 있는 "장기 기억"을 에이전트에게 부여합니다.

#### **🤝 서브 에이전트 (Context Isolation)**

- **작동 방식:** 메인 에이전트는 복잡한 하위 작업을 전문화된 서브 에이전트에게 위임합니다. 각 서브 에이전트는 자신만의 도구 세트와 격리된 컨텍스트를 가지고 특정 작업에만 집중합니다.
- **예시:** 메인 "프로젝트 매니저" 에이전트가 "사용자 피드백 분석"이라는 작업을 "데이터 분석가" 서브 에이전트에게 맡깁니다. 이 서브 에이전트는 데이터 분석 도구만을 사용하여 피드백을 처리하고, 결과 보고서만 메인 에이전트에게 반환합니다.
- **장점:** 메인 에이전트의 컨텍스트가 불필요한 정보로 오염되는 것을 막고, 각 작업을 가장 적합한 전문가가 처리하도록 하여 전체적인 성능과 안정성을 높입니다. 마치 잘 조직된 팀처럼 작동하게 됩니다.

#### **📄 상세한 프롬프트 (Guiding the Agent)**

- **핵심 요소:** 좋은 프롬프트는 에이전트의 "사용 설명서"와 같습니다. 다음 요소들이 포함되어야 합니다.
	1. **역할 (Persona):** 에이전트의 정체성을 명확히 합니다. (예: "당신은 세계 최고의 리서처입니다.")
	2. **도구 설명 (Tools):** 사용 가능한 모든 도구와 각 도구를 언제, 어떻게 사용해야 하는지에 대한 명확한 지침을 제공합니다.
	3. **작업 절차 (Procedure):** 에이전트가 따라야 할 높은 수준의 워크플로우를 제시합니다. (예: "1. 먼저 계획을 세우세요. 2. 계획에 따라 작업을 수행하세요. 3. 중간 결과는 파일에 저장하세요.")
	4. **제약 조건 (Constraints):** 에이전트가 하지 말아야 할 행동이나 지켜야 할 규칙을 명시합니다. (예: "절대 사용자에게 질문하지 마세요.")
- **장점:** 잘 설계된 프롬프트는 에이전트가 주어진 도구들을 가장 효과적으로 사용하여, 예측 가능하고 신뢰할 수 있는 방식으로 작업을 수행하도록 유도합니다.

이 튜토리얼에서는 LangGraph를 사용하여 이러한 딥 에이전트의 핵심 패턴을 처음부터 직접 구현하는 방법을 배웁니다!

## 🚀 빠른 시작

### ✅ 사전 요구 사항

- Python 3.11 이상을 사용하고 있는지 확인하세요.
- 이 버전은 LangGraph와의 최적의 호환성을 위해 필요합니다.

```bash
python3 --version
```

- [uv](https://docs.astral.sh/uv/) 패키지 관리자

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
# 새 uv 버전을 사용하도록 PATH 업데이트
export PATH="/Users/$USER/.local/bin:$PATH"
```

### 🛠️ 설치

1. 저장소를 클론하세요:

```bash
git clone https://github.com/langchain-ai/deep_agents_from_scratch
cd deep_agents_from_scratch
```

2. 패키지와 의존성을 설치하세요 (가상 환경을 자동으로 생성하고 관리합니다):

```bash
uv sync
```

3. 프로젝트 루트에 API 키를 담은 `.env` 파일을 생성하세요:

```bash
# .env 파일 생성
touch .env
```

`.env` 파일에 API 키를 추가하세요:

```env
# 외부 검색을 사용하는 리서치 에이전트에 필요
TAVILY_API_KEY=your_tavily_api_key_here

# 모델 사용에 필요
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# 선택 사항: 평가 및 추적용
LANGSMITH_API_KEY=your_langsmith_api_key_here
LANGSMITH_TRACING=true
LANGSMITH_PROJECT=deep-agents-from-scratch
```

1. `uv`를 사용하여 노트북이나 코드를 실행하세요:

```bash
# Jupyter 노트북 직접 실행
uv run jupyter notebook

# 또는 선호하는 경우 가상 환경 활성화
source .venv/bin/activate # Windows: .venv\Scripts\activate
jupyter notebook
```

## 📚 튜토리얼 개요

이 저장소에는 고급 AI 에이전트 구축 방법을 알려주는 5개의 점진적인 노트북이 포함되어 있습니다:

### `0_create_agent.ipynb`

`create_agent` 컴포넌트 사용법을 배우세요. 이 컴포넌트는,
- 많은 에이전트의 기반이 되는 ReAct (Reason - Act) 루프를 구현합니다.
- 사용하기 쉽고 빠르게 설정할 수 있습니다.

### `1_todo.ipynb` - 📝 작업 계획의 기초

TODO 목록을 사용하여 구조화된 작업 계획을 구현하는 방법을 배우세요. 이 노트북에서는 다음을 소개합니다:
- 상태 관리(pending/in_progress/completed)를 통한 작업 추적
- 진행 상황 모니터링 및 컨텍스트 관리
- 복잡한 다단계 워크플로우를 구성하기 위한 `write_todos()` 도구
- 집중을 유지하고 작업 이탈을 방지하기 위한 모범 사례

### `2_files.ipynb` - 🗂️ 가상 파일 시스템

컨텍스트 오프로딩을 위해 에이전트 상태에 저장된 가상 파일 시스템을 구현합니다:
- 파일 작업: `ls()`, `read_file()`, `write_file()`, `edit_file()`
- 정보 지속성을 통한 컨텍스트 관리
- 대화 턴 간에 에이전트 "메모리" 활성화
- 파일에 상세 정보를 저장하여 토큰 사용량 감소

### `3_subagents.ipynb` - 🤝 컨텍스트 격리

복잡한 워크플로우를 처리하기 위한 서브 에이전트 위임을 마스터하세요:
- 집중된 도구 세트를 가진 전문화된 서브 에이전트 생성
- 혼란과 작업 간섭을 방지하기 위한 컨텍스트 격리
- `task()` 위임 도구 및 에이전트 레지스트리 패턴
- 독립적인 연구 스트림을 위한 병렬 실행 기능

### `4_full_agent.ipynb` - 🤖 완전한 리서치 에이전트

모든 기술을 결합하여 프로덕션 준비가 된 리서치 에이전트를 만드세요:
- TODO, 파일, 서브 에이전트의 통합
- 지능적인 컨텍스트 오프로딩을 통한 실제 웹 검색
- 콘텐츠 요약 및 전략적 사고 도구
- LangGraph Studio 통합을 통한 복잡한 연구 작업을 위한 완전한 워크플로우

각 노트북은 이전 개념을 바탕으로 구축되며, 실제 연구 및 분석 작업을 처리할 수 있는 정교한 에이전트 아키텍처로 마무리됩니다.
